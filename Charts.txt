üìä –®–ø–æ—Ä–∞ –ø–æ Windows Forms Chart (System.Windows.Forms.DataVisualization.Charting)

1 ‚Äì –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π ¬´Hello Chart¬ª

// –î–æ–ø–∏—à–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ —Ñ–æ—Ä–º—ã –ø–æ—Å–ª–µ InitializeComponent()
chart1.Series.Clear();                       // —á–∏—Å—Ç–∏–º –Ω–∞ –≤—Å—è–∫–∏–π
var s = chart1.Series.Add("–û—Ü–µ–Ω–∫–∏");         // –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ª–µ–≥–µ–Ω–¥—ã
s.ChartType = SeriesChartType.Column;        // Column, Line, Pie‚Ä¶
s.Points.AddXY("–ê–Ω—è",  5);
s.Points.AddXY("–ë–æ—Ä–∏—Å",4);
s.Points.AddXY("–í–æ–≤–∞", 3);

2 ‚Äì –ü—Ä–∏–≤—è–∑–∫–∞ –∫ DataTable (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±)

DataTable dt = ExecToTable(
    "SELECT student_name, AVG(GradeValue) AS AvgMark " +
    "FROM ViewStudentMarks GROUP BY student_name", null);

chart1.Series.Clear();
var s = chart1.Series.Add("–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª");
s.ChartType = SeriesChartType.Line;          // –∏–ª–∏ Column / Area / Spline
s.XValueMember = "student_name";
s.YValueMembers = "AvgMark";

chart1.DataSource = dt;
chart1.DataBind();                           // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!

> üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏
‚Ä¢ XValueMember / YValueMembers ‚Äì –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ DataTable, –∞ –Ω–µ —Å–≤–æ–π—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–∞.
‚Ä¢ –î–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö ¬´Y¬ª —Å—Ç–æ–ª–±—Ü–æ–≤ –ø–µ—Ä–µ—á–∏—Å–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: YValueMembers = "Col1,Col2".



3 ‚Äì –û—Å–∏ –∏ –ø–æ–¥–ø–∏—Å–∏

chart1.ChartAreas[0].AxisX.Interval       = 1;             // –∫–∞–∂–¥–∞—è –º–µ—Ç–∫–∞
chart1.ChartAreas[0].AxisX.Title          = "–°—Ç—É–¥–µ–Ω—Ç—ã";
chart1.ChartAreas[0].AxisY.Title          = "–ë–∞–ª–ª";
chart1.ChartAreas[0].AxisY.Minimum        = 0;
chart1.ChartAreas[0].AxisY.Maximum        = 5;
chart1.Series[0].IsValueShownAsLabel      = true;          // –ø–æ–¥–ø–∏—Å–∏ –Ω–∞–¥ —Å—Ç–æ–ª–±—Ü–∞–º–∏

4 ‚Äì –°–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç –∏ –º–∞—Ä–∫–µ—Ä—ã ¬´–Ω–∞ –ª–µ—Ç—É¬ª

var ser = chart1.Series[0];
ser.Color            = Color.SteelBlue;
ser.BorderWidth      = 2;
ser.MarkerStyle      = MarkerStyle.Circle;
ser.MarkerSize       = 8;
ser.MarkerColor      = Color.DarkRed;

5 ‚Äì –î–≤–µ (–∏ –±–æ–ª—å—à–µ) —Å–µ—Ä–∏–π –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ

// –°–µ—Ä–∏—è ¬´–≥—Ä—É–ø–ø–∞ –≤ —Ü–µ–ª–æ–º¬ª
var g = chart1.Series.Add("–ì—Ä—É–ø–ø–∞");
g.ChartType         = SeriesChartType.Line;
g.BorderWidth       = 3;
g.Points.AddXY("–§–µ–≤", 3.9);
g.Points.AddXY("–ú–∞—Ä", 4.1);

// –°–µ—Ä–∏—è ¬´–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ç—É–¥–µ–Ω—Ç¬ª
var st = chart1.Series.Add("–ò–≤–∞–Ω–æ–≤ –ò.–ò.");
st.ChartType        = SeriesChartType.Line;
st.BorderDashStyle  = ChartDashStyle.Dot;
st.Color            = Color.OrangeRed;
st.Points.AddXY("–§–µ–≤", 4);
st.Points.AddXY("–ú–∞—Ä", 5);

6 ‚Äì –ë—ã—Å—Ç—Ä–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

void RefreshChart()
{
    chart1.Series[0].Points.Clear();
    foreach (DataRow r in dt.Rows)
        chart1.Series[0].Points.AddXY(r["student_name"], r["AvgMark"]);
}

7 ‚Äì –°–∫—Ä–∏–Ω—à–æ—Ç –≥—Ä–∞—Ñ–∏–∫–∞ (–¥–ª—è –æ—Ç—á—ë—Ç–∞)

chart1.SaveImage(@"C:\tmp\marks.png", ChartImageFormat.Png);

8 ‚Äì –°–∞–º—ã–µ –Ω—É–∂–Ω—ã–µ SeriesChartType

–¢–∏–ø	–ü–µ—Ä–µ–≤–æ–¥/–∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

Column, Bar	–°—Ç–æ–ª–±—Ü—ã/–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
Line, Spline, Area	–¢—Ä–µ–Ω–¥—ã –≤–æ –≤—Ä–µ–º–µ–Ω–∏
Pie, Doughnut	–î–æ–ª–∏ / %
Point, Bubble	–†–∞–∑–±—Ä–æ—Å, –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞—Å—Å–µ—è–Ω–∏—è
StackedColumn, StackedArea, StackedBar	–°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω


9 ‚Äì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–°–∏–º–ø—Ç–æ–º	–†–µ—à–µ–Ω–∏–µ

¬´–ù–∏—á–µ–≥–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è¬ª	–ü—Ä–æ–≤–µ—Ä—å DataBind() –∏ —á—Ç–æ —Å–µ—Ä–∏–π –Ω–µ—Ç –¥–æ –±–∏–Ω–¥–∞.
–î—É–±–ª–∏—Ä—É—é—Ç—Å—è –º–µ—Ç–∫–∏ X	AxisX.Interval = 1;
–ù—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤ (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ/—Å–∫—Ä–æ–ª–ª)	chart1.ChartAreas[0].CursorX.IsUserEnabled = true; –∏ Zoomable = true.
–ü–∞–¥–∞–µ—Ç –ø—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ç–∏–ø–æ–≤	–£–±–µ–¥–∏—Å—å, —á—Ç–æ DataTable –æ—Ç–¥–∞—ë—Ç —á–∏—Å–ª–∞, –∞ –Ω–µ —Å—Ç—Ä–æ–∫–∏.


10 ‚Äì –≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ —É—Å–ø–µ—Ö–∞

1. chart1.Series.Clear();


2. Series s = chart1.Series.Add("–ò–º—è");


3. s.ChartType = ‚Ä¶;


4. –ó–∞–ø–æ–ª–Ω—è–µ–º s.Points –∏–ª–∏ –Ω–∞–∑–Ω–∞—á–∞–µ–º DataSource –∏ DataBind().



–≠—Ç–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ + –ø—Ä–∏–º–µ—Ä–æ–≤ –≤—ã—à–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –ª—é–±–æ–π –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ –∑–∞ –ø–∞—Ä—É –º–∏–Ω—É—Ç. –£–¥–∞—á–∏!

